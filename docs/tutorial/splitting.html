<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-tutorial/splitting" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v2.4.3">
<title data-rh="true">06 - Splitting | Rivet</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://rivet.ironcladapp.com/img/social-card.png"><meta data-rh="true" name="twitter:image" content="https://rivet.ironcladapp.com/img/social-card.png"><meta data-rh="true" property="og:url" content="https://rivet.ironcladapp.com/docs/tutorial/splitting"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="06 - Splitting | Rivet"><meta data-rh="true" name="description" content="Let&#x27;s say you want to summarize a long document. You could divide the document into an array of smaller pieces of text (chunking), and then iterate over each piece of text to summarize it (splitting), before summarizing the summaries."><meta data-rh="true" property="og:description" content="Let&#x27;s say you want to summarize a long document. You could divide the document into an array of smaller pieces of text (chunking), and then iterate over each piece of text to summarize it (splitting), before summarizing the summaries."><link data-rh="true" rel="icon" href="/img/favicon.png"><link data-rh="true" rel="canonical" href="https://rivet.ironcladapp.com/docs/tutorial/splitting"><link data-rh="true" rel="alternate" href="https://rivet.ironcladapp.com/docs/tutorial/splitting" hreflang="en"><link data-rh="true" rel="alternate" href="https://rivet.ironcladapp.com/docs/tutorial/splitting" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.6666e11c.css">
<link rel="preload" href="/assets/js/runtime~main.ba5b8098.js" as="script">
<link rel="preload" href="/assets/js/main.05b43666.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}return t}()||function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div role="region" aria-label="Skip to main content"><a class="skipToContent_QXLn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Rivet Logo" class="themedImage_xd2l themedImage--light_r6yD"><img src="/img/logo.svg" alt="Rivet Logo" class="themedImage_xd2l themedImage--dark_Wxbp"></div><b class="navbar__title text--truncate">Rivet</b></a><a class="navbar__item navbar__link" href="/docs">User Guide</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/tutorial">Tutorial</a><a class="navbar__item navbar__link" href="/docs/api-reference">API Reference</a><a class="navbar__item navbar__link" href="/docs/node-reference">Node Reference</a><a class="navbar__item navbar__link" href="/docs/cli">CLI</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/ironclad/rivet" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_YGOo"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_IDoG colorModeToggle_WRUd"><button class="clean-btn toggleButton_ettb toggleButtonDisabled_Ktf1" type="button" disabled="" title="Switch between dark and light mode (currently dark mode)" aria-label="Switch between dark and light mode (currently dark mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_NRy2"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_Fn3x"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_Tbn_"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_B4Ie docsWrapper_vPSh"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_HAST" type="button"></button><div class="docPage_iY0a"><aside class="theme-doc-sidebar-container docSidebarContainer_r5_D"><div class="sidebarViewport_DJt3"><div class="sidebar_gyMu"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_TBPW"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorial">Rivet Tutorial</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorial/installing-getting-started">00 - Installing &amp; Overview</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorial/simple-graph">01 - Simple Graph</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorial/interpolation-more-node-types">02 - Interpolation &amp; More Node Types</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorial/matching-conditionals">03 - Matching &amp; Conditionals</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorial/yaml">04 - YAML</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorial/subgraphs">05 - Subgraphs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" href="/docs/tutorial/splitting">06 - Splitting</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/tutorial/loops">07 - Loops</a></li></ul></nav></div></div></aside><main class="docMainContainer_TAmz"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_T029"><div class="docItemContainer_tiI6"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_nPXr" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_Jfba"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">06 - Splitting</span><meta itemprop="position" content="1"></li></ul></nav><div class="tocCollapsible_ujn6 theme-doc-toc-mobile tocMobile_znf_"><button type="button" class="clean-btn tocCollapsibleButton_OvvE">On this page</button></div><div class="theme-doc-markdown markdown"><h1>Splitting (and Chunking)</h1><p>Let&#x27;s say you want to summarize a long document. You could divide the document into an array of smaller pieces of text (chunking), and then iterate over each piece of text to summarize it (splitting), before summarizing the summaries.</p><blockquote><p>For this tutorial, we will use the graph in the &quot;6. Splitting&quot; folder. Download the <a href="https://github.com/Ironclad/rivet/blob/main/packages/app/src/assets/tutorials/documentation-tutorial.rivet-project" target="_blank" rel="noopener noreferrer">documentation-tutorial.rivet-project here</a> and open it in Rivet to follow along!</p></blockquote><h2 class="anchor anchorWithStickyNavbar_FGaV" id="chunking">Chunking<a href="#chunking" class="hash-link" aria-label="Direct link to Chunking" title="Direct link to Chunking">​</a></h2><p>The first step of dividing a document into an array is called &quot;chunking&quot; in Rivet. The <a href="/docs/node-reference/chunk">Chunk Node</a> takes a string, and divides it into chunks of a certain token size.</p><p>Try running the tutorial example, and notice that the Chunk Node output has N elements. Now, try increasing overlap to 50%. The output likely now has more than N elements. Overlap makes each chunk share some text from the beginning and end of the next and previous chunks. This is helpful to account for sentences or ideas that might otherwise be split across chunks.</p><p>In the screenshot below, you can see that &quot;3.2 XYZ&#x27;s Responsibilities&quot; appears in both chunk 0 and 1, while &quot;5. Compensation&quot; appears in both chunk 1 and 2.</p><p><img loading="lazy" alt="Chunking with Overlap" src="/assets/images/06-chunking-with-overlap-bb5e7e3855bbdfbc50a532f8f521ec9f.png" width="3260" height="1168" class="img_M8z1"></p><h2 class="anchor anchorWithStickyNavbar_FGaV" id="splitting">Splitting<a href="#splitting" class="hash-link" aria-label="Direct link to Splitting" title="Direct link to Splitting">​</a></h2><p>The next step is iterating over each piece of text in the array. In Rivet, nodes have a &quot;split mode,&quot; which allows them to iterate over arrays. When split mode is on, the split icon (circled below in red) will show next to the node title.</p><p><img loading="lazy" alt="Split node icon" src="/assets/images/06-split-node-6fb563727744551c1be29851f120fc45.png" width="327" height="296" class="img_M8z1"></p><p>Try running the tutorial example, and notice that the Text Node outputs an array, with the text chunks inserted into the template.</p><p><img loading="lazy" alt="Split node output" src="/assets/images/06-split-node-output-2b32ef404a5e8024a3a90bda774c5572.png" width="1861" height="1260" class="img_M8z1"></p><p>Now, turn off split mode, and run the graph. Notice that the output is a single string, with the chunk items all concatenated together (&quot;This is chunk 1 2 3 4...&quot; is happening because the <code>index</code> input is also an array). This is eventually how we will transform the array of summaries into a single answer.</p><p><img loading="lazy" alt="Split node off" src="/assets/images/06-split-node-off-0a40c81022cc1811d182d68fa50706de.png" width="1884" height="1104" class="img_M8z1"></p><p>Split mode can be configured with max and sequential. Max specifies the max iterations. Try setting it to 2, and notice that the remaining items get ignored. Sequential specifies whether to iterate over items one at a time, or in parallel.</p><p><img loading="lazy" alt="Split node configuration" src="/assets/images/06-split-node-config-e91e3e5ac22619d981d68600f72eebde.png" width="492" height="308" class="img_M8z1"></p><p>Now, notice that the Text Node has three inputs: <code>index</code>, <code>count</code>, and <code>data</code>. <code>index</code> is an array of sequential numbers, from 0 to N. <code>data</code> is the array of N text chunks. In split mode, these arrays are iterated over together, so that the i-th index is processed with the i-th text chunk. The <code>count</code> input is not an array, so it will stay constant throughout.</p><blockquote><p>Warning: Try to keep input arrays to split nodes the same length. Otherwise, Rivet will go back to the start of any arrays that are shorter (which is unlikely to be the behavior you&#x27;re looking for).</p></blockquote><h2 class="anchor anchorWithStickyNavbar_FGaV" id="combining">Combining<a href="#combining" class="hash-link" aria-label="Direct link to Combining" title="Direct link to Combining">​</a></h2><p>You can link nodes with split mode enabled to transform each item in an array. In the tutorial example, notice the split icon across the three nodes in the middle (Text, Chat, Text). The first Text Node inserts each chunk into a prompt template for summarization. Then, the Chat Node summarizes each chunk individually. Finally, the other Text Node adds some context for the summary.</p><p><img loading="lazy" alt="Sequence of split nodes" src="/assets/images/06-split-sequence-5ca0adb1852a8b03bd1bf27c4bf74859.png" width="2688" height="586" class="img_M8z1"></p><p>The resulting string array of summaries (and context about which chunk the summary comes from) is then combined into a Text Node with split mode turned off. By default, the string array input will get &quot;coerced&quot; into a string type by concatenating each item with a newline. If you want to combine them in a different way, consider something like the <a href="/docs/node-reference/join">Join Node</a>.</p></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/ironclad/rivet/tree/main/packages/docs/docs/tutorial/06-splitting.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_M6J_" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_Zrhk"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/tutorial/subgraphs"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">05 - Subgraphs</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/tutorial/loops"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">07 - Loops</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_vSir thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#chunking" class="table-of-contents__link toc-highlight">Chunking</a></li><li><a href="#splitting" class="table-of-contents__link toc-highlight">Splitting</a></li><li><a href="#combining" class="table-of-contents__link toc-highlight">Combining</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started/installation">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/docs">User Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/api-reference">API Reference</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://discord.gg/qT8B2gv9Mg" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_YGOo"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://github.com/ironclad/rivet" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_YGOo"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://www.youtube.com/@rivet_ts" target="_blank" rel="noopener noreferrer" class="footer__link-item">YouTube<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_YGOo"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2025 Ironclad. Built with Docusaurus.</div></div></div></footer></div>
<script src="/assets/js/runtime~main.ba5b8098.js"></script>
<script src="/assets/js/main.05b43666.js"></script>
</body>
</html>