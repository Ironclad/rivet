"use strict";(self.webpackChunkdocs=self.webpackChunkdocs||[]).push([[4008],{1042:(e,t,n)=>{n.d(t,{Zo:()=>u,kt:()=>f});var r=n(3249);function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n,r,a={},i=Object.keys(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||(a[n]=e[n]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(r=0;r<i.length;r++)n=i[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}var s=r.createContext({}),p=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):o(o({},t),e)),n},u=function(e){var t=p(e.components);return r.createElement(s.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},h=r.forwardRef((function(e,t){var n=e.components,a=e.mdxType,i=e.originalType,s=e.parentName,u=l(e,["components","mdxType","originalType","parentName"]),c=p(n),h=a,f=c["".concat(s,".").concat(h)]||c[h]||d[h]||i;return n?r.createElement(f,o(o({ref:t},u),{},{components:n})):r.createElement(f,o({ref:t},u))}));function f(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=n.length,o=new Array(i);o[0]=h;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[c]="string"==typeof e?e:a,o[1]=l;for(var p=2;p<i;p++)o[p]=n[p];return r.createElement.apply(null,o)}return r.createElement.apply(null,n)}h.displayName="MDXCreateElement"},4684:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>o,default:()=>d,frontMatter:()=>i,metadata:()=>l,toc:()=>p});var r=n(7396),a=(n(3249),n(1042));const i={title:"Splitting"},o=void 0,l={unversionedId:"user-guide/splitting",id:"user-guide/splitting",title:"Splitting",description:"Splitting a node is a powerful tool for parallelizing execution. Change a node to a Split node by toggling on Split on any node:",source:"@site/docs/user-guide/splitting.md",sourceDirName:"user-guide",slug:"/user-guide/splitting",permalink:"/docs/user-guide/splitting",draft:!1,editUrl:"https://github.com/ironclad/rivet/tree/main/packages/docs/docs/user-guide/splitting.md",tags:[],version:"current",frontMatter:{title:"Splitting"},sidebar:"userGuide",previous:{title:"Executing AI Chains",permalink:"/docs/user-guide/executing-ai-chains"},next:{title:"Subgraphs",permalink:"/docs/user-guide/subgraphs"}},s={},p=[{value:"Use Cases",id:"use-cases",level:2},{value:"Chaining",id:"chaining",level:2},{value:"Joining",id:"joining",level:2},{value:"Nested Splitting and Arrays of Arrays",id:"nested-splitting-and-arrays-of-arrays",level:2}],u={toc:p},c="wrapper";function d(e){let{components:t,...i}=e;return(0,a.kt)(c,(0,r.Z)({},u,i,{components:t,mdxType:"MDXLayout"}),(0,a.kt)("p",null,"Splitting a node is a powerful tool for parallelizing execution. Change a node to a Split node by toggling on Split on any node:"),(0,a.kt)("p",null,(0,a.kt)("img",{alt:"Splitting a node",src:n(1838).Z,width:"692",height:"354"})),(0,a.kt)("p",null,"When a node is split:"),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"The node will be executed N times, in parallel"),(0,a.kt)("li",{parentName:"ul"},"The input types for the input ports of the node can be arrays of the same type of data that would normally be accepted by the node"),(0,a.kt)("li",{parentName:"ul"},"The output types for the output ports of the node will be arrays of data of the same type that would normally be output by the node"),(0,a.kt)("li",{parentName:"ul"},"Each execution of the node will be given a single value from the array of data, and executed normally. The output of each execution will be collected into an array, and the array will be output from the node."),(0,a.kt)("li",{parentName:"ul"},"If the input value is not an array, then it will be treated as an array of N copies of the value, where N is the length of the array given to another input port. For example, if one port is given a string ",(0,a.kt)("inlineCode",{parentName:"li"},'"value"'),", and another port is given an array of 3 numbers, then the node will be executed 3 times, and each execution will be given the string ",(0,a.kt)("inlineCode",{parentName:"li"},'"value"'),"."),(0,a.kt)("li",{parentName:"ul"},"If multiple values are arrays, then the values will be zipped together for each execution. For example, if one port is given a (string, string), and another port a (number, number), then each execution will be given a (string, number) as its inputs.")),(0,a.kt)("h2",{id:"use-cases"},"Use Cases"),(0,a.kt)("p",null,"Splitting is most useful for parallelizing execution. For example, you could use a ",(0,a.kt)("a",{parentName:"p",href:"../node-reference/read-directory"},"Read Directory Node")," to read a directory of files. This gives an array of strings. You can then pipe this into a ",(0,a.kt)("a",{parentName:"p",href:"../node-reference/read-file"},"Read File Node")," which has Split turned on, to read each file in parallel. The output of the Read File node will be an array of strings."),(0,a.kt)("h2",{id:"chaining"},"Chaining"),(0,a.kt)("p",null,"The most powerful feature of splitting is its ability to chain splits."),(0,a.kt)("p",null,"For the above example, the Read File could then be piped into a split ",(0,a.kt)("a",{parentName:"p",href:"../node-reference/text"},"Text Node"),", to interpolate the contents of each file into another string. The split Text node can then be piped into a split ",(0,a.kt)("a",{parentName:"p",href:"../node-reference/chat"},"Chat Node"),", to send each file's contents to a chatbot in parallel. The output of the Chat node will be an array of strings, giving you the response from the AI for each file."),(0,a.kt)("h2",{id:"joining"},"Joining"),(0,a.kt)("p",null,"At some point you will likely wish to join split nodes back into non-split nodes. There are a few ways to accomplish this."),(0,a.kt)("ul",null,(0,a.kt)("li",{parentName:"ul"},"When an array of strings is passed into a ",(0,a.kt)("a",{parentName:"li",href:"../node-reference/text"},"Text Node")," or a ",(0,a.kt)("a",{parentName:"li",href:"../node-reference/prompt"},"Prompt Node"),", the node will join the array of strings into a single string, separated by newlines. This is the most common method of joining."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"../node-reference/chat"},"Chat Node")," can accept an array of strings or chat messages to its Prompt input."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"../node-reference/extract-object-path"},"Extract Object Path")," node can be used to extract a single value from an array of objects."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"../node-reference/pop"},"Pop Node")," node can be used to extract a single value from an array of any type."),(0,a.kt)("li",{parentName:"ul"},"The ",(0,a.kt)("a",{parentName:"li",href:"../node-reference/code"},"Code Node")," node can be used to write custom code to join arrays of data, such as using the ",(0,a.kt)("a",{parentName:"li",href:"https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/Reduce"},"Array.prototype.reduce")," function.")),(0,a.kt)("h2",{id:"nested-splitting-and-arrays-of-arrays"},"Nested Splitting and Arrays of Arrays"),(0,a.kt)("p",null,"Nested splitting and arrays of arrays are ",(0,a.kt)("strong",{parentName:"p"},"not supported"),". However, this can be partially worked around by using a split ",(0,a.kt)("a",{parentName:"p",href:"../node-reference/subgraph"},"Subgraph Node"),". Since the subgraph is split, the graph itself will be executed multiple times in parallel. The subgraph can then contain more nodes with splitting turned on, effectively allowing for nested splitting to any degree. However do be careful with excessive splitting, or recursive splitting that may cause infinite loops."))}d.isMDXComponent=!0},1838:(e,t,n)=>{n.d(t,{Z:()=>r});const r=n.p+"assets/images/split-node-8b2d3c9c2d7f90244dc3289b0e61a14b.png"}}]);